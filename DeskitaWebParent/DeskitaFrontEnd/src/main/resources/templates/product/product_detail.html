<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity5"
>

<head th:replace="components/head_title :: page_head('Deskita')">

<body>
	<style>
		.list_image{
		    display: flex;
   
    list-style: none;}
    .image_item{
    	width: 100%;
    }
    .main-image img{
    	max-width: 100%;
    }
    .main-image{
   	background: white;
    border-radius: 30px;
    box-shadow: 1px 1px 9pc #0000000d;
    padding: 20px;
    }
    .image{
    	background: white;
    	border-radius: 30px;
    	box-shadow: 1px 1px 9pc #0000000d;
    	padding: 10px;
    	cursor: pointer;
    }
    .list_product_details{
    	display:flex;
    }
   	.btn_product_detail {
    margin-right: 15px;
    background: white;
    color: black;
    border: none;
    padding: 15px 30px;
    border-radius: 15px;
    font-weight: bold;
    box-shadow: 1px 1px 9pc #0000000d;
}
button.btn_order_now{

    background: #a29bfe;
    color: white;
    border: none;
    padding: 15px 50px;
    border-radius: 15px;
    font-weight: bold;
    box-shadow: 1px 1px 9pc #0000000d;
}
.btn_product_detail.active_product_detail{
	background: #74b9ff;
    color: white;
}
	</style>
	<div th:replace="components/navigation :: navigation"></div>
	<br>
	<br>
	<!-- product detail -->
	<div class=" container-fluid product_detail">
	<form th:action="@{/add-cart/}+${product.id}" method="post" id="form_product">
	<input type="hidden" th:name="product_name" th:value="${product.name}"/>
	<input type="hidden" th:name="product_image" th:value="${product.image}"/>
		<div class="row">
			<div class="col-md-6 images" >
			<div class="main-image text-center">
				<img th:src="@{'/images/'+${product.image}}" class="image_main">
			</div>
			<br>
			<ul class="list_image row">
				<li th:each="productImage: ${productImages}" class="col-md-4" >
					<div class="image">
					<img th:src="@{'/images/'+${productImage.url}}" class="image_item" >
					</div>
					
				</li>
			</ul>
				
			</div>
			<div class="col-md-6">
			
				<h3 th:text="${product.name}" > </h3>
				<p th:text=${product.shortDescription}></p>	
				<br>
				<p th:text=${product.fullDescription}></p>
				<br>
				<div>
					<span th:utext="#{homepage.productDetail.label.category}">Thể loại: </span>
					<span th:text="${product.category.getName()}"></span>
				</div>
				<br>
				<span>Thương hiệu</span>
				<img th:src="@{'/images/brands/'+${product.getBrand().getLogo()}}" style="height: 40px">
				<br>
				<br>
				<div>
					<span>Giá: </span>
					<span id="min_max_price"></span>
					<span>USD</span>
				</div>
				<br>
				<div class="list_product_details">
				
				<div th:each="productDetail: ${productDetails}">
					<input type="button" class="btn_product_detail" th:value="${productDetail.name}" th:data="${productDetail.value}" th:field="*{productDetail}" >
						
						<input type="hidden" th:value="${productDetail.value}">
						<input th:value="${productDetail.stock}" type="hidden">
					</input>
					
				</div>
				<input type="hidden" id="product_detail_name_selected" th:name="product_detail_name_selected" value=""  />
					
				
				</div>
				<br>
				<br>	
				<button class="btn_order_now"> Mua ngay</button>
			</div>
		</div>
		</form>
	</div>
	<script>
	Array.max = function( array ){
        return Math.max.apply( Math, array );
    };
    Array.min = function( array ){
        return Math.min.apply( Math, array );
     };
		var listPrice=[];
		$(".btn_product_detail").each(function(){
			listPrice.push(parseFloat($(this).attr('data')))
		})
	
			$("#min_max_price").text(Array.min(listPrice)+'-'+Array.max(listPrice));
		
		
		console.log(listPrice)
		$(".image_item").click(function(){
			$(".image_main").attr("src",$(this).attr('src'));
		})
		$(".btn_product_detail").click(function(){
			if($(this).hasClass("active_product_detail")){
				$(".btn_product_detail").removeClass("active_product_detail");
				$("#product_detail_name_selected").val("");
				
				$("#min_max_price").text(Array.min(listPrice)+'-'+Array.max(listPrice));
				
				
				return;
			}
			$(".btn_product_detail").removeClass("active_product_detail");
			$(this).addClass("active_product_detail");
			$("#min_max_price").text($(this).attr('data'));
			$("#product_detail_name_selected").val($(this).val());
		})
		$('#form_product').submit(function() {
		  // your code here
		  
		  if(!$('#product_detail_name_selected').val()){
			  event.preventDefault();
			  alert("Vui lòng chọn variation")
		  }
		 
		});
	</script>
</body>
</html>